<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS2 Demo Analyzer - OpenSight</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom scrollbar for dark theme */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b;
        }
        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Drop zone animation */
        .drop-zone-active {
            border-color: #3b82f6 !important;
            background-color: rgba(59, 130, 246, 0.1) !important;
        }

        /* Spinner animation */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .spinner {
            animation: spin 1s linear infinite;
        }

        /* Tab transitions */
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }

        /* Rating color classes */
        .rating-excellent { color: #22c55e; }
        .rating-good { color: #84cc16; }
        .rating-average { color: #eab308; }
        .rating-below { color: #f97316; }
        .rating-poor { color: #ef4444; }
    </style>
</head>
<body class="bg-slate-900 text-slate-200 font-sans min-h-screen flex">

    <!-- Fixed Sidebar Navigation -->
    <aside id="sidebar" class="fixed left-0 top-0 h-screen w-64 bg-slate-950 border-r border-slate-800 flex flex-col z-50">
        <!-- Logo -->
        <div class="p-6 border-b border-slate-800">
            <h1 class="text-2xl font-bold bg-gradient-to-r from-cyan-400 to-purple-500 bg-clip-text text-transparent">
                OpenSight
            </h1>
            <p class="text-xs text-slate-500 mt-1">CS2 Analytics Platform</p>
        </div>

        <!-- Navigation -->
        <nav class="flex-1 py-4">
            <div class="px-3 mb-2">
                <span class="text-xs font-semibold text-slate-500 uppercase tracking-wider">Analysis</span>
            </div>

            <button class="sidebar-item active w-full text-left px-6 py-3 border-l-2 border-transparent flex items-center gap-3" data-tab="overview">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
                </svg>
                Overview
            </button>

            <button class="sidebar-item w-full text-left px-6 py-3 border-l-2 border-transparent flex items-center gap-3 text-slate-400" data-tab="heatmaps">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
                </svg>
                Heatmaps
            </button>

            <button class="sidebar-item w-full text-left px-6 py-3 border-l-2 border-transparent flex items-center gap-3 text-slate-400" data-tab="killmap">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                </svg>
                Kill Map
            </button>

            <button class="sidebar-item w-full text-left px-6 py-3 border-l-2 border-transparent flex items-center gap-3 text-slate-400" data-tab="utility">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"/>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.879 16.121A3 3 0 1012.015 11L11 14H9c0 .768.293 1.536.879 2.121z"/>
                </svg>
                Utility
            </button>

            <button class="sidebar-item w-full text-left px-6 py-3 border-l-2 border-transparent flex items-center gap-3 text-slate-400" data-tab="compare">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                </svg>
                Compare
            </button>

            <div class="px-3 mt-6 mb-2">
                <span class="text-xs font-semibold text-slate-500 uppercase tracking-wider">Match Data</span>
            </div>

            <button class="sidebar-item w-full text-left px-6 py-3 border-l-2 border-transparent flex items-center gap-3 text-slate-400" data-tab="players">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"/>
                </svg>
                Players
            </button>

            <button class="sidebar-item w-full text-left px-6 py-3 border-l-2 border-transparent flex items-center gap-3 text-slate-400" data-tab="timeline">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                </svg>
                Timeline
            </button>

            <button class="sidebar-item w-full text-left px-6 py-3 border-l-2 border-transparent flex items-center gap-3 text-slate-400" data-tab="coaching">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                </svg>
                AI Coaching
            </button>
        </nav>

        <!-- Footer -->
        <div class="p-4 border-t border-slate-800">
            <div class="text-xs text-slate-500">
                <p>100% Free &amp; Local</p>
                <a href="https://github.com/nukethe02/cs2-analyzer" target="_blank" class="text-cyan-400 hover:underline">GitHub</a>
            </div>
        </div>
    </aside>

    <main class="ml-64 flex-1 min-h-screen">
        <!-- Upload Section -->
        <section id="upload-section" class="mb-8">
            <div
                id="drop-zone"
                class="border-2 border-dashed border-slate-600 rounded-lg p-12 text-center cursor-pointer hover:border-slate-500 hover:bg-slate-800/50 transition-all duration-200"
            >
                <div id="upload-content">
                    <svg class="mx-auto h-12 w-12 text-slate-500 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                    </svg>
                    <p class="text-lg text-slate-300 mb-2">Drop your demo file here</p>
                    <p class="text-sm text-slate-500 mb-4">or click to browse</p>
                    <p class="text-xs text-slate-600">Supports .dem and .dem.gz files up to 500MB</p>
                </div>
                <input type="file" id="file-input" class="hidden" accept=".dem,.dem.gz">
            </div>

            <!-- Progress Indicator -->
            <div id="progress-section" class="hidden mt-6">
                <div class="bg-slate-800 rounded-lg p-6 text-center">
                    <svg class="spinner mx-auto h-10 w-10 text-blue-500 mb-4" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <p id="progress-text" class="text-slate-300">Uploading demo...</p>
                    <div class="mt-4 w-full bg-slate-700 rounded-full h-2">
                        <div id="progress-bar" class="bg-blue-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                    <p id="progress-detail" class="text-sm text-slate-500 mt-2"></p>
                </div>
            </div>

            <!-- Error Message -->
            <div id="error-section" class="hidden mt-6">
                <div class="bg-red-900/30 border border-red-800 rounded-lg p-4">
                    <div class="flex items-start">
                        <svg class="h-5 w-5 text-red-500 mt-0.5 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        <div>
                            <h3 class="text-red-400 font-medium">Analysis Error</h3>
                            <p id="error-message" class="text-red-300 text-sm mt-1"></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section id="results-section" class="hidden">
            <!-- Tab Navigation -->
            <div class="flex border-b border-slate-700 mb-6">
                <button
                    id="tab-overview"
                    class="tab-btn px-6 py-3 text-sm font-medium border-b-2 border-blue-500 text-blue-400"
                    data-tab="overview"
                >
                    Overview
                </button>
                <button
                    id="tab-advanced"
                    class="tab-btn px-6 py-3 text-sm font-medium border-b-2 border-transparent text-slate-400 hover:text-slate-300"
                    data-tab="advanced"
                >
                    Advanced
                </button>
            </div>

            <!-- Overview Tab -->
            <div id="content-overview" class="tab-content active">
                <!-- Match Overview Card -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                    <div class="bg-slate-800 rounded-lg p-6">
                        <h3 class="text-slate-400 text-sm font-medium uppercase tracking-wider mb-3">Map</h3>
                        <p id="match-map" class="text-2xl font-bold text-white">-</p>
                    </div>
                    <div class="bg-slate-800 rounded-lg p-6">
                        <h3 class="text-slate-400 text-sm font-medium uppercase tracking-wider mb-3">Score</h3>
                        <p id="match-score" class="text-2xl font-bold text-white">-</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Kill Map Tab -->
        <section id="tab-killmap" class="tab-content hidden p-8">
            <div id="killmap-content" class="max-w-6xl mx-auto">
                <div class="flex items-center justify-between mb-8">
                    <div>
                        <h2 class="text-2xl font-bold text-white">Kill Map</h2>
                        <p class="text-slate-400 mt-1">Visualize kill locations on the radar</p>
                    </div>
                </div>

                <div id="killmap-placeholder" class="bg-slate-800/50 rounded-xl border border-slate-700 p-16 text-center">
                    <svg class="w-16 h-16 mx-auto text-slate-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                    </svg>
                    <p class="text-slate-500">Upload a demo file to view kill map</p>
                </div>
            </div>

                <div id="killmap-display" class="hidden">
                    <!-- Kill Map controls and radar -->
                    <div class="bg-slate-800/50 rounded-xl border border-slate-700 p-6">
                        <!-- Filters -->
                        <div class="flex flex-wrap gap-4 mb-6 items-center justify-between">
                            <div class="flex gap-4">
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" id="killmap-show-ct" checked class="w-4 h-4 accent-ct">
                                    <span class="text-sm text-ct font-medium">CT Kills</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" id="killmap-show-t" checked class="w-4 h-4 accent-t">
                                    <span class="text-sm text-t font-medium">T Kills</span>
                                </label>
                                <label class="flex items-center gap-2 cursor-pointer">
                                    <input type="checkbox" id="killmap-show-hs" checked class="w-4 h-4 accent-yellow-500">
                                    <span class="text-sm text-slate-300">Highlight Headshots</span>
                                </label>
                            </div>
                            <div class="flex gap-4">
                                <select id="killmap-player-filter" class="bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm">
                                    <option value="all">All Players</option>
                                </select>
                                <select id="killmap-round-filter" class="bg-slate-700 border border-slate-600 rounded-lg px-3 py-2 text-sm">
                                    <option value="all">All Rounds</option>
                                </select>
                            </div>
                        </div>

                        <!-- Map Container -->
                        <div id="killmap-container" class="relative w-full max-w-4xl mx-auto aspect-square rounded-lg overflow-hidden bg-slate-900">
                            <!-- Radar background image -->
                            <div id="killmap-radar" class="absolute inset-0 bg-center bg-contain bg-no-repeat"></div>
                            <!-- Kill dots overlay -->
                            <div id="killmap-overlay" class="absolute inset-0"></div>
                            <!-- Tooltip -->
                            <div id="killmap-tooltip" class="absolute hidden bg-slate-800 border border-slate-600 rounded-lg px-3 py-2 text-sm pointer-events-none z-50 shadow-xl"></div>
                            <!-- Loading/Error state -->
                            <div id="killmap-loading" class="absolute inset-0 flex items-center justify-center text-slate-500 hidden">
                                Loading map...
                            </div>
                            <div id="killmap-no-map" class="absolute inset-0 flex items-center justify-center text-slate-500 hidden">
                                <div class="text-center">
                                    <svg class="w-12 h-12 mx-auto mb-2 text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
                                    </svg>
                                    <p>Map preview not available for this map</p>
                                    <p class="text-xs mt-1">Kill data is still shown in the table below</p>
                                </div>
                            </div>
                        </div>

                        <!-- Legend -->
                        <div class="flex justify-center gap-8 mt-4 text-sm">
                            <div class="flex items-center gap-2">
                                <span class="w-3 h-3 rounded-full bg-ct shadow-lg shadow-ct/40"></span>
                                <span class="text-slate-400">CT Kill</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="w-3 h-3 rounded-full bg-t shadow-lg shadow-t/40"></span>
                                <span class="text-slate-400">T Kill</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="w-3 h-3 rounded-full bg-yellow-400 ring-2 ring-yellow-300/50"></span>
                                <span class="text-slate-400">Headshot</span>
                            </div>
                        </div>

                        <!-- Stats Summary -->
                        <div id="killmap-stats" class="grid grid-cols-4 gap-4 mt-6 pt-6 border-t border-slate-700">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-ct" id="killmap-ct-kills">0</div>
                                <div class="text-xs text-slate-500 uppercase">CT Kills</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-t" id="killmap-t-kills">0</div>
                                <div class="text-xs text-slate-500 uppercase">T Kills</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-yellow-400" id="killmap-headshots">0</div>
                                <div class="text-xs text-slate-500 uppercase">Headshots</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-slate-300" id="killmap-total">0</div>
                                <div class="text-xs text-slate-500 uppercase">Total Kills</div>
                            </div>
                        </div>
                    </div>

                    <!-- Kill List Table -->
                    <div class="bg-slate-800/50 rounded-xl border border-slate-700 p-6 mt-6">
                        <h3 class="text-lg font-semibold text-white mb-4">Kill Feed</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead>
                                    <tr class="text-slate-400 border-b border-slate-700">
                                        <th class="text-left py-2 px-3">Round</th>
                                        <th class="text-left py-2 px-3">Attacker</th>
                                        <th class="text-left py-2 px-3">Weapon</th>
                                        <th class="text-left py-2 px-3">Victim</th>
                                        <th class="text-center py-2 px-3">HS</th>
                                    </tr>
                                </thead>
                                <tbody id="killmap-table-body" class="divide-y divide-slate-700/50">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Share Code Decode -->
                    <div class="mt-6 p-6 bg-slate-800 rounded-xl">
                        <h3 class="text-lg font-semibold text-white mb-3">Or Decode Share Code</h3>
                        <div class="flex gap-3">
                            <input type="text" id="sharecode-input" placeholder="CSGO-xxxxx-xxxxx-xxxxx-xxxxx-xxxxx"
                                   class="flex-1 px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white placeholder-slate-400 focus:outline-none focus:border-blue-500">
                            <button id="decode-btn" class="px-6 py-2 bg-slate-600 hover:bg-slate-500 text-white font-medium rounded-lg transition-colors">
                                Decode
                            </button>
                        </div>
                        <div id="decode-result" class="mt-3 text-sm hidden"></div>
                    </div>
                </div>

                <!-- Match Info Row -->
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                    <div class="bg-slate-800 rounded-lg p-4">
                        <h4 class="text-slate-500 text-xs uppercase tracking-wider mb-1">Tick Rate</h4>
                        <p id="match-tickrate" class="text-lg font-semibold text-slate-200">-</p>
                    </div>
                    <div class="bg-slate-800 rounded-lg p-4">
                        <h4 class="text-slate-500 text-xs uppercase tracking-wider mb-1">Duration</h4>
                        <p id="match-duration" class="text-lg font-semibold text-slate-200">-</p>
                    </div>
                    <div class="bg-slate-800 rounded-lg p-4">
                        <h4 class="text-slate-500 text-xs uppercase tracking-wider mb-1">Total Kills</h4>
                        <p id="match-kills" class="text-lg font-semibold text-slate-200">-</p>
                    </div>
                    <div class="bg-slate-800 rounded-lg p-4">
                        <h4 class="text-slate-500 text-xs uppercase tracking-wider mb-1">MVP</h4>
                        <p id="match-mvp" class="text-lg font-semibold text-slate-200">-</p>
                    </div>
                </div>

                <!-- Players Table -->
                <div class="bg-slate-800 rounded-lg overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-700">
                        <h2 class="text-lg font-semibold text-white">Player Statistics</h2>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-slate-700/50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">Player</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">K</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">D</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">A</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">K/D</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">HS%</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">ADR</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">Rating</th>
                                </tr>
                            </thead>
                            <tbody id="players-table-body" class="divide-y divide-slate-700">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Advanced Tab -->
            <div id="content-advanced" class="tab-content">
                <!-- Advanced Metrics Table -->
                <div class="bg-slate-800 rounded-lg overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-700">
                        <h2 class="text-lg font-semibold text-white">Advanced Metrics</h2>
                        <p class="text-sm text-slate-400 mt-1">Time to Damage (TTD) and Crosshair Placement (CP) analysis</p>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead class="bg-slate-700/50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-slate-400 uppercase tracking-wider">Player</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">ADR</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">KAST%</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">Mean TTD (ms)</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">Median CP (deg)</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">Aim Rating</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">Entry Rate</th>
                                    <th class="px-4 py-3 text-center text-xs font-medium text-slate-400 uppercase tracking-wider">Utility</th>
                                </tr>
                            </thead>
                            <tbody id="advanced-table-body" class="divide-y divide-slate-700">
                                <!-- Populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Metric Benchmarks -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                    <div class="bg-slate-800 rounded-lg p-6">
                        <h3 class="text-white font-semibold mb-4">TTD Benchmarks</h3>
                        <ul class="space-y-2 text-sm">
                            <li class="flex justify-between"><span class="text-slate-400">Elite</span><span class="rating-excellent">&lt;200ms</span></li>
                            <li class="flex justify-between"><span class="text-slate-400">Good</span><span class="rating-good">200-350ms</span></li>
                            <li class="flex justify-between"><span class="text-slate-400">Average</span><span class="rating-average">350-500ms</span></li>
                            <li class="flex justify-between"><span class="text-slate-400">Slow</span><span class="rating-poor">&gt;500ms</span></li>
                        </ul>
                    </div>
                    <div class="bg-slate-800 rounded-lg p-6">
                        <h3 class="text-white font-semibold mb-4">Crosshair Placement Benchmarks</h3>
                        <ul class="space-y-2 text-sm">
                            <li class="flex justify-between"><span class="text-slate-400">Elite</span><span class="rating-excellent">&lt;5&deg;</span></li>
                            <li class="flex justify-between"><span class="text-slate-400">Good</span><span class="rating-good">5-15&deg;</span></li>
                            <li class="flex justify-between"><span class="text-slate-400">Average</span><span class="rating-average">15-25&deg;</span></li>
                            <li class="flex justify-between"><span class="text-slate-400">Needs Work</span><span class="rating-poor">&gt;25&deg;</span></li>
                        </ul>
                    </div>
                </div>

                <!-- Weapons Tab -->
                <div id="tab-weapons" class="tab-content">
                    <div class="bg-slate-800 rounded-xl p-6">
                        <!-- Player Selection -->
                        <div class="mb-6">
                            <label class="block text-sm font-medium text-slate-300 mb-2">Select Player</label>
                            <select id="weapons-player-select" class="w-full max-w-md px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg text-white focus:outline-none focus:border-blue-500">
                                <!-- Options populated by JS -->
                            </select>
                        </div>

                        <!-- Weapons Table -->
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead>
                                    <tr class="bg-slate-700/50 text-left text-sm text-slate-300">
                                        <th class="px-6 py-3 font-semibold">Weapon</th>
                                        <th class="px-6 py-3 font-semibold text-center">Kills</th>
                                        <th class="px-6 py-3 font-semibold text-center">HS%</th>
                                        <th class="px-6 py-3 font-semibold text-center">Damage</th>
                                        <th class="px-6 py-3 font-semibold text-center">Shots</th>
                                        <th class="px-6 py-3 font-semibold text-center">Accuracy</th>
                                    </tr>
                                </thead>
                                <tbody id="weapons-table" class="divide-y divide-slate-700">
                                    <!-- Weapon rows populated by JS -->
                                </tbody>
                            </table>
                        </div>

                        <!-- No Data Message -->
                        <div id="weapons-no-data" class="hidden text-center py-8 text-slate-400">
                            <p>No weapon data available for this player</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-slate-800 border-t border-slate-700 mt-auto">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <p class="text-center text-sm text-slate-500">
                OpenSight - Professional-grade CS2 demo analysis
            </p>
        </div>
    </footer>

    <script>
        // DOM Elements
        // =============================================================================
        const uploadSection = document.getElementById('upload-section');
        const dashboardContent = document.getElementById('dashboard-content');
        const loadingOverlay = document.getElementById('loading-overlay');
        const dropZone = document.getElementById('drop-zone');
        const fileInput = document.getElementById('file-input');
        const browseBtn = document.getElementById('browse-btn');
        const sharecodeInput = document.getElementById('sharecode-input');
        const decodeBtn = document.getElementById('decode-btn');
        const decodeResult = document.getElementById('decode-result');
        const newAnalysisBtn = document.getElementById('new-analysis-btn');

        // Navigation buttons
        const navBtns = {
            overview: document.getElementById('nav-overview'),
            advanced: document.getElementById('nav-advanced'),
            compare: document.getElementById('nav-compare'),
            weapons: document.getElementById('nav-weapons')
        };

        // Tab contents
        const tabContents = {
            overview: document.getElementById('tab-overview'),
            advanced: document.getElementById('tab-advanced'),
            compare: document.getElementById('tab-compare'),
            weapons: document.getElementById('tab-weapons')
        };

        // =============================================================================
        // Utility Functions
        // =============================================================================
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function formatNumber(num, decimals = 1) {
            if (num === null || num === undefined) return 'N/A';
            return Number(num).toFixed(decimals);
        }

        function getRatingColor(rating) {
            if (rating >= 1.3) return 'text-green-400';
            if (rating >= 1.1) return 'text-emerald-400';
            if (rating >= 0.9) return 'text-yellow-400';
            if (rating >= 0.7) return 'text-orange-400';
            return 'text-red-400';
        }

        function getTeamBadge(team) {
            if (team === 'CT') {
                return '<span class="px-2 py-1 text-xs font-semibold rounded bg-blue-500/20 text-blue-400">CT</span>';
            } else {
                return '<span class="px-2 py-1 text-xs font-semibold rounded bg-yellow-500/20 text-yellow-400">T</span>';
            }
        }

        function getTierBadge(value, thresholds, labels, inverse = false) {
            let tier, color;
            if (inverse) {
                if (value <= thresholds[0]) { tier = labels[0]; color = 'bg-green-500/20 text-green-400'; }
                else if (value <= thresholds[1]) { tier = labels[1]; color = 'bg-emerald-500/20 text-emerald-400'; }
                else if (value <= thresholds[2]) { tier = labels[2]; color = 'bg-yellow-500/20 text-yellow-400'; }
                else { tier = labels[3]; color = 'bg-red-500/20 text-red-400'; }
            } else {
                if (value >= thresholds[0]) { tier = labels[0]; color = 'bg-green-500/20 text-green-400'; }
                else if (value >= thresholds[1]) { tier = labels[1]; color = 'bg-emerald-500/20 text-emerald-400'; }
                else if (value >= thresholds[2]) { tier = labels[2]; color = 'bg-yellow-500/20 text-yellow-400'; }
                else { tier = labels[3]; color = 'bg-red-500/20 text-red-400'; }
            }
            return `<span class="px-2 py-1 text-xs font-semibold rounded ${color}">${tier}</span>`;
        }

        // =============================================================================
        // Navigation
        // =============================================================================
        function switchTab(tabName) {
            // Update nav buttons
            Object.keys(navBtns).forEach(key => {
                navBtns[key].classList.remove('active', 'bg-slate-700', 'text-white');
                navBtns[key].classList.add('text-slate-400', 'hover:bg-slate-700/50', 'hover:text-white');
            });
            navBtns[tabName].classList.add('active', 'bg-slate-700', 'text-white');
            navBtns[tabName].classList.remove('text-slate-400', 'hover:bg-slate-700/50', 'hover:text-white');

                // Initialize tab-specific content if data exists
                if (analysisData) {
                    if (tab === 'heatmaps') initHeatmap(analysisData.heatmap_data || {});
                    if (tab === 'killmap') renderKillMapContent();
                }
            });
            tabContents[tabName].classList.add('active');

            // Re-render compare chart if switching to compare tab
            if (tabName === 'compare' && currentMatchData) {
                setTimeout(() => renderCompare(), 100);
            }
        }

        // Add event listeners to nav buttons
        Object.keys(navBtns).forEach(key => {
            navBtns[key].addEventListener('click', () => switchTab(key));
        });

        // Initialize nav button styles
        switchTab('overview');

        // =============================================================================
        // File Upload
        // =============================================================================
        browseBtn.addEventListener('click', () => fileInput.click());

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                uploadFile(e.target.files[0]);
            }
        });

        // Drag and drop
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('drag-over');
        });

        dropZone.addEventListener('dragleave', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');
            if (e.dataTransfer.files.length > 0) {
                uploadFile(e.dataTransfer.files[0]);
            }
        });

        async function uploadFile(file) {
            // Validate file
            const validExtensions = ['.dem', '.dem.gz'];
            const fileName = file.name.toLowerCase();
            if (!validExtensions.some(ext => fileName.endsWith(ext))) {
                alert('Please upload a .dem or .dem.gz file');
                return;
            }

            if (file.size > 500 * 1024 * 1024) {
                alert('File size exceeds 500MB limit');
                return;
            }

        // Format numbers
        function formatNumber(num, decimals = 1) {
            if (num === null || num === undefined) return '-';
            return Number(num).toFixed(decimals);
        }

        // Get rating class based on HLTV rating
        function getRatingClass(rating) {
            if (rating >= 1.3) return 'rating-excellent';
            if (rating >= 1.1) return 'rating-good';
            if (rating >= 0.9) return 'rating-average';
            if (rating >= 0.7) return 'rating-below';
            return 'rating-poor';
        }

        // Get TTD rating class
        function getTtdClass(ttd) {
            if (ttd === null || ttd === undefined) return '';
            if (ttd < 200) return 'rating-excellent';
            if (ttd < 350) return 'rating-good';
            if (ttd < 500) return 'rating-average';
            return 'rating-poor';
        }

        // Get CP rating class
        function getCpClass(cp) {
            if (cp === null || cp === undefined) return '';
            if (cp < 5) return 'rating-excellent';
            if (cp < 15) return 'rating-good';
            if (cp < 25) return 'rating-average';
            return 'rating-poor';
        }

        // Tab Navigation
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tabId = btn.dataset.tab;

                // Update button states
                document.querySelectorAll('.tab-btn').forEach(b => {
                    b.classList.remove('border-blue-500', 'text-blue-400');
                    b.classList.add('border-transparent', 'text-slate-400');
                });
                btn.classList.remove('border-transparent', 'text-slate-400');
                btn.classList.add('border-blue-500', 'text-blue-400');

                const data = await response.json();
                decodeResult.classList.remove('hidden');

                if (response.ok) {
                    decodeResult.className = 'mt-3 text-sm p-3 bg-slate-700 rounded-lg';
                    decodeResult.innerHTML = `
                        <p class="text-green-400 font-semibold mb-2">Decoded Successfully</p>
                        <p><span class="text-slate-400">Match ID:</span> <span class="font-mono-num">${escapeHtml(data.match_id || 'N/A')}</span></p>
                        <p><span class="text-slate-400">Outcome ID:</span> <span class="font-mono-num">${escapeHtml(data.outcome_id || 'N/A')}</span></p>
                        <p><span class="text-slate-400">Token:</span> <span class="font-mono-num">${escapeHtml(data.token || 'N/A')}</span></p>
                    `;
                } else {
                    decodeResult.className = 'mt-3 text-sm p-3 bg-red-900/30 rounded-lg text-red-400';
                    decodeResult.textContent = data.detail || 'Failed to decode share code';
                }
            } catch (error) {
                decodeResult.classList.remove('hidden');
                decodeResult.className = 'mt-3 text-sm p-3 bg-red-900/30 rounded-lg text-red-400';
                decodeResult.textContent = 'Error: ' + error.message;
            }
        });

        // =============================================================================
        // Dashboard Display
        // =============================================================================
        function showDashboard() {
            uploadSection.classList.add('hidden');
            dashboardContent.classList.remove('hidden');
            renderMatchHeader();
            renderOverview();
            renderAdvanced();
            populatePlayerSelects();
            populateWeaponsSelect();
        }

        newAnalysisBtn.addEventListener('click', () => {
            currentMatchData = null;
            dashboardContent.classList.add('hidden');
            uploadSection.classList.remove('hidden');
            fileInput.value = '';
        });

        // =============================================================================
        // Render Match Header
        // =============================================================================
        function renderMatchHeader() {
            const data = currentMatchData;
            document.getElementById('map-name').textContent = escapeHtml(data.map_name || 'Unknown Map');
            document.getElementById('match-score').textContent = `${data.team1_score || 0} - ${data.team2_score || 0}`;
            document.getElementById('match-rounds').textContent = `${data.total_rounds || 0} rounds`;
            document.getElementById('tick-rate').textContent = `${data.tick_rate || 64} tick`;
        }

        // =============================================================================
        // Render Overview Tab
        // =============================================================================
        function renderOverview() {
            const players = Object.values(currentMatchData.players || {});

            // Sort by rating descending
            players.sort((a, b) => (b.hltv_rating || 0) - (a.hltv_rating || 0));

            const tableBody = document.getElementById('players-table');
            tableBody.innerHTML = players.map((p, i) => {
                const kdDiff = (p.kills || 0) - (p.deaths || 0);
                const kdDiffClass = kdDiff > 0 ? 'text-green-400' : kdDiff < 0 ? 'text-red-400' : 'text-slate-400';
                const kdDiffStr = kdDiff > 0 ? `+${kdDiff}` : kdDiff.toString();
                const rowBg = i % 2 === 0 ? 'bg-slate-800' : 'bg-slate-800/50';

                return `
                    <tr class="${rowBg} hover:bg-slate-700/50 transition-colors">
                        <td class="px-6 py-4">
                            <span class="font-medium text-white">${escapeHtml(p.name || 'Unknown')}</span>
                        </td>
                        <td class="px-6 py-4 text-center">${getTeamBadge(p.team)}</td>
                        <td class="px-6 py-4 text-center font-mono-num">${p.kills || 0}</td>
                        <td class="px-6 py-4 text-center font-mono-num">${p.deaths || 0}</td>
                        <td class="px-6 py-4 text-center font-mono-num">${p.assists || 0}</td>
                        <td class="px-6 py-4 text-center font-mono-num ${kdDiffClass}">${kdDiffStr}</td>
                        <td class="px-6 py-4 text-center font-mono-num">${formatNumber(p.adr, 1)}</td>
                        <td class="px-6 py-4 text-center font-mono-num">${formatNumber(p.headshot_percentage, 0)}%</td>
                        <td class="px-6 py-4 text-center font-mono-num">${formatNumber(p.kast_percentage, 0)}%</td>
                        <td class="px-6 py-4 text-center">
                            <span class="font-mono-num font-semibold ${getRatingColor(p.hltv_rating || 0)}">${formatNumber(p.hltv_rating, 2)}</span>
                        </td>
                    </tr>
                `;
            }).join('');

            // Render kill matrix
            renderKillMatrix(players);
        }

        function renderKillMatrix(players) {
            const container = document.getElementById('kill-matrix-container');
            const killMatrix = currentMatchData.kill_matrix || [];

            if (players.length === 0) {
                container.innerHTML = '<p class="text-slate-400">No kill data available</p>';
                return;
            }

            // Show placeholders become real content
            renderPlayersContent(ctPlayers, tPlayers);
            renderUtilityContent(players);
            renderTimelineContent(data.rounds || []);
            renderCoachingContent(data.coaching || []);
            renderCompareContent(players);
            renderHeatmapContent();
            renderKillMapContent();

            // Create table
            let html = '<table class="min-w-full text-sm">';

            // Header row
            html += '<thead><tr><th class="px-3 py-2 text-left text-slate-400 font-medium">Attacker \\ Victim</th>';
            players.forEach(p => {
                html += `<th class="px-3 py-2 text-center text-slate-300 font-medium">${escapeHtml(p.name?.substring(0, 10) || '?')}</th>`;
            });
            html += '</tr></thead><tbody>';

                    // Reset all placeholders
                    ['players', 'utility', 'timeline', 'coaching', 'compare', 'heatmap', 'killmap'].forEach(tab => {
                        const display = document.getElementById(`${tab}-display`);
                        const placeholder = document.getElementById(`${tab}-placeholder`);
                        if (display) display.classList.add('hidden');
                        if (placeholder) placeholder.classList.remove('hidden');
                    });
                });
                document.getElementById(`content-${tabId}`).classList.add('active');
            });
        });

        // File Input Handlers
        dropZone.addEventListener('click', () => fileInput.click());

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('drop-zone-active');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('drop-zone-active');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drop-zone-active');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        fileInput.addEventListener('change', () => {
            if (fileInput.files.length > 0) {
                handleFile(fileInput.files[0]);
            }
        });

        // Show/Hide UI States
        function showProgress() {
            progressSection.classList.remove('hidden');
            errorSection.classList.add('hidden');
            resultsSection.classList.add('hidden');
        }

        function showError(message) {
            progressSection.classList.add('hidden');
            errorSection.classList.remove('hidden');
            errorMessage.textContent = message;
        }

        function showResults() {
            progressSection.classList.add('hidden');
            errorSection.classList.add('hidden');
            resultsSection.classList.remove('hidden');
        }
    </script>

        function updateProgress(text, percent, detail = '') {
            progressText.textContent = text;
            progressBar.style.width = `${percent}%`;
            progressDetail.textContent = detail;
        }

        // Poll for job status
        async function pollJobStatus(jobId) {
            const pollInterval = 1000; // 1 second
            const maxAttempts = 600; // 10 minutes max
            let attempts = 0;

            while (attempts < maxAttempts) {
                try {
                    const response = await fetch(`/analyze/${jobId}`);
                    const data = await response.json();

                    if (data.status === 'completed') {
                        updateProgress('Analysis complete!', 100);
                        return data.result;
                    } else if (data.status === 'failed') {
                        throw new Error(data.error || 'Analysis failed');
                    } else if (data.status === 'processing') {
                        const progress = data.progress || 0;
                        updateProgress('Analyzing demo...', Math.max(10, progress), `${progress}% complete`);
                    } else {
                        updateProgress('Waiting in queue...', 5, 'Job queued');
                    }
                } catch (error) {
                    throw error;
                }

                await new Promise(resolve => setTimeout(resolve, pollInterval));
                attempts++;
            }

            throw new Error('Analysis timed out');
        }

        // Handle File Upload
        async function handleFile(file) {
            // Validate file
            const validExtensions = ['.dem', '.dem.gz'];
            const fileName = file.name.toLowerCase();
            const isValid = validExtensions.some(ext => fileName.endsWith(ext));

            if (!isValid) {
                showError('Invalid file type. Please upload a .dem or .dem.gz file.');
                return;
            }

            if (file.size > 500 * 1024 * 1024) {
                showError('File too large. Maximum size is 500MB.');
                return;
            }

            showProgress();
            updateProgress('Uploading demo...', 0, `${(file.size / 1024 / 1024).toFixed(1)} MB`);

            try {
                // Upload file
                const formData = new FormData();
                formData.append('file', file);

                const uploadResponse = await fetch('/analyze', {
                    method: 'POST',
                    body: formData
                });

                if (!uploadResponse.ok) {
                    const errorData = await uploadResponse.json().catch(() => ({}));
                    throw new Error(errorData.detail || `Upload failed: ${uploadResponse.status}`);
                }

                const uploadResult = await uploadResponse.json();
                updateProgress('Processing demo...', 10, 'Job submitted');

                // Poll for results
                const result = await pollJobStatus(uploadResult.job_id);

                // Display results
                displayResults(result);
                showResults();

            } catch (error) {
                console.error('Analysis error:', error);
                showError(error.message || 'An unexpected error occurred');
            }
        }

        // Display Results
        function displayResults(data) {
            const demoInfo = data.demo_info || {};
            const players = data.players || {};

            // Match Overview
            document.getElementById('match-map').textContent = escapeHtml(demoInfo.map || 'Unknown');
            document.getElementById('match-score').textContent = escapeHtml(demoInfo.score || '-');
            document.getElementById('match-rounds').textContent = demoInfo.rounds || '-';
            document.getElementById('match-tickrate').textContent = demoInfo.tick_rate ? `${demoInfo.tick_rate} tick` : '-';
            document.getElementById('match-duration').textContent = demoInfo.duration_minutes ? `${formatNumber(demoInfo.duration_minutes, 1)} min` : '-';
            document.getElementById('match-kills').textContent = demoInfo.total_kills || '-';

            // MVP
            if (data.mvp) {
                document.getElementById('match-mvp').textContent = escapeHtml(data.mvp.name);
            } else {
                document.getElementById('match-mvp').textContent = '-';
            }

            // Convert players object to array and sort by rating
            const playerList = Object.entries(players).map(([steamId, player]) => ({
                steamId,
                ...player
            })).sort((a, b) => {
                const ratingA = a.rating?.hltv_rating || 0;
                const ratingB = b.rating?.hltv_rating || 0;
                return ratingB - ratingA;
            });

            // Populate Overview Table
            playersTableBody.innerHTML = playerList.map(player => {
                const stats = player.stats || {};
                const rating = player.rating || {};
                const ratingValue = rating.hltv_rating || 0;
                const ratingClass = getRatingClass(ratingValue);
                const teamClass = player.team === 'CT' ? 'text-blue-400' : 'text-yellow-400';

                return `
                    <tr class="hover:bg-slate-700/50">
                        <td class="px-4 py-3">
                            <div class="flex items-center">
                                <span class="${teamClass} font-medium mr-2">${escapeHtml(player.team || '')}</span>
                                <span class="text-white font-medium">${escapeHtml(player.name || 'Unknown')}</span>
                            </div>
                        </td>
                        <td class="px-4 py-3 text-center text-slate-300">${stats.kills || 0}</td>
                        <td class="px-4 py-3 text-center text-slate-300">${stats.deaths || 0}</td>
                        <td class="px-4 py-3 text-center text-slate-300">${stats.assists || 0}</td>
                        <td class="px-4 py-3 text-center text-slate-300">${formatNumber(stats.kd_ratio, 2)}</td>
                        <td class="px-4 py-3 text-center text-slate-300">${formatNumber(stats.headshot_pct, 0)}%</td>
                        <td class="px-4 py-3 text-center text-slate-300">${formatNumber(stats.adr, 1)}</td>
                        <td class="px-4 py-3 text-center font-semibold ${ratingClass}">${formatNumber(ratingValue, 2)}</td>
                    </tr>
                `;
            }).join('');

            // Populate Advanced Table
            advancedTableBody.innerHTML = playerList.map(player => {
                const stats = player.stats || {};
                const rating = player.rating || {};
                const advanced = player.advanced || {};
                const utility = player.utility || {};

                const ttdValue = advanced.ttd_mean_ms;
                const cpValue = advanced.cp_median_error_deg;
                const ttdClass = getTtdClass(ttdValue);
                const cpClass = getCpClass(cpValue);
                const teamClass = player.team === 'CT' ? 'text-blue-400' : 'text-yellow-400';

                return `
                    <tr class="hover:bg-slate-700/50">
                        <td class="px-4 py-3">
                            <div class="flex items-center">
                                <span class="${teamClass} font-medium mr-2">${escapeHtml(player.team || '')}</span>
                                <span class="text-white font-medium">${escapeHtml(player.name || 'Unknown')}</span>
                            </div>
                        </td>
                        <td class="px-4 py-3 text-center text-slate-300">${formatNumber(stats.adr, 1)}</td>
                        <td class="px-4 py-3 text-center text-slate-300">${formatNumber(rating.kast_percentage, 0)}%</td>
                        <td class="px-4 py-3 text-center ${ttdClass}">${ttdValue !== null && ttdValue !== undefined ? formatNumber(ttdValue, 0) : '-'}</td>
                        <td class="px-4 py-3 text-center ${cpClass}">${cpValue !== null && cpValue !== undefined ? formatNumber(cpValue, 1) + '' : '-'}</td>
                        <td class="px-4 py-3 text-center text-slate-300">${formatNumber(rating.aim_rating, 0)}</td>
                        <td class="px-4 py-3 text-center text-slate-300">${formatNumber(rating.entry_success_rate, 0)}%</td>
                        <td class="px-4 py-3 text-center text-slate-300">${formatNumber(rating.utility_rating, 0)}</td>
                    </tr>
                `;
            }).join('');
        }
    </script>
</body>
</html>
